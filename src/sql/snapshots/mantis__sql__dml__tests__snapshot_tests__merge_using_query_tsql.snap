---
source: src/sql/dml.rs
expression: sql
---
MERGE INTO [users] AS [t] USING (SELECT
  [id],
  [name]
FROM [staging_users]
WHERE [processed] = 0) AS [s] ON [t].[id] = [s].[id] WHEN MATCHED THEN UPDATE SET [name] = [s].[name] WHEN NOT MATCHED THEN INSERT ([id], [name]) VALUES ([s].[id], [s].[name]);
